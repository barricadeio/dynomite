machine:
  pre:
  - |
    sudo curl -L -o /usr/bin/circle-docker 'https://archive.barricade.io/binaries/circle-docker/circle-docker.sh'
    sudo chmod 0755 /usr/bin/circle-docker
  services:
    - docker

dependencies:
  cache_directories:
    - "~/docker"
  override:
    - circle-docker cached_build docker-dynomite

test:
  override:
    - circle-docker env

deployment:
  production:
    branch: production
    owner: barricadeio
    commands:
      - circle-docker push docker-dynomite
  testing:
    branch: master
    owner: barricadeio
    commands:
      - circle-docker push docker-dynomite
